<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head th:replace="partials/layout :: header (page='Topic')">
    <meta charset="UTF-8" />
    <title>Home</title>
</head>
<div th:replace="partials/layout :: navbar" />
<span class="overlay"></span>
<div th:replace="partials/layout :: navbar-profile" />

</div>


<div class="container bg-white text-center border border-dark rounded mt-5" sec:authorize="isAuthenticated()">

    <table class="table table-hover">
        <thead>
            <tr>
                <th></th>
                <th class="sticky-top" >User</th>
                <th class="sticky-top">From</th>
                <th class="d-none d-sm-table-cell sticky-top">Post</th>
            </tr>
        </thead>
        <tbody>
        <th:block th:each="post: ${posts}" th:height="auto" >
            <tr class="posts" th:data-id="${post.id}">
                <td>
                    <img th:if="${post.user.profile.uploadPath}"  th:src="@{/uploads/} + ${post.user.profile.uploadPath}"  class="message-md-avatar" />

                </td>
                <td>
                    <span th:text="${post.user.profile.firstName}" ></span>
                </td>
                <td>
                    <span th:text="${post.user.profile.userState}" ></span>
                </td>
                <td>
                    <span th:text="${post.message}" ></span>
                </td>

                <td>
                    <button type="button" th:data-recipient-id="${post.user.id}" th:data-recipient-name="${post.user.username}" class="btn btn-secondary" data-toggle="modal" data-target="#exampleModal">Send message</button>
                    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">New message</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <form th:action="@{/messages/create}" method="post">
                                    <div class="modal-body">

                                        <div class="form-group">
                                            <label for="recipient-name" class="col-form-label">Recipient:</label>
                                            <span id="recipient-name">James Turner</span>
                                        </div>
                                        <div class="form-group">
                                            <label for="message-text" class="col-form-label">Message:</label>
                                            <textarea class="form-control" id="message-text" name="message"></textarea>

                                        </div>

                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                        <button type="submit" class="btn btn-primary">Send message</button>

                                    </div>

                                    <input type="hidden" name="recipient-id" id="recipient-id" />
                                </form>
                            </div>
                        </div>
                    </div>
                    <!--<form class="input-group" th:action="@{/messages/create}" method="post" th:object="${post}">-->

                    <!--<input type="text" id="message" name="message" />-->
                    <!--<input class="form-control" type="hidden" id="recipient-id" name="recipient-id" th:value="${post.user.id}" />-->

                    <!--<div class="input-group-append">-->
                        <!--<button class="form-control btn btn-primary input-group-append">Send</button>-->
                    <!--</div>-->
                    <!--</form>-->
                </td>
            </tr>

            </th:block>
        </tbody>
    </table>


</div>
<div th:replace="partials/layout :: footer" />

</body>
</html>