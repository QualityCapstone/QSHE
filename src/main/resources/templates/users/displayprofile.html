<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head th:replace="partials/layout :: header">
    <meta charset="UTF-8">
    <title>Your Profile</title>
</head>
<body>
<div th:replace="states/svg :: states-svg" />
<div th:replace="partials/layout :: navbar" />
<!--<div class="col-12">-->
    <nav class="navbar navbar-expand-lg navbar-light bg-light m-auto">
        <a class="navbar-brand" href="/users/displayprofile">PROFILE</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
            <ul class="navbar-nav m-auto" id="navprofile">
                <li class="nav-item d-inline">
                    <!--<img src="/img/4391 - Around the Globe.png"/>-->
                    <a class="nav-link" href="/us">Map<img src="/img/icon-map.png" class="ml-1"/></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/users/rating">Your rating<img src="/img/icon-user-rating.png" class="ml-1"/></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/users">Friends<img src="/img/icon-user-network.png" class="ml-1"/></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Messages<img src="/img/icon-messages.png" class="ml-1"/></a>
                </li>
            </ul>
        </div>
    </nav>

<!--</div>-->
<!--state news modal-->
<!--body continues to scroll while user is scrolling through modal-->
<div class="modal fade" id="modal" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" style="margin-left: 125px" id="exampleModalLongTitle" th:text="Latest + ' ' + ${state.name} + ' ' + News"></h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <ul id="morenews"></ul>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<div class="container ">
    <div class="userProfile row">
        <div class="col-md-6  col-sm-12">
            <div id="profile-user" class="card card-border m-3">

                <div class="card-title text-left pt-3">
                    <a class="pr-2 float-right" th:href="@{/editprofile}"><i class="fas fa-edit"></i> </a>
                    <h3>Welcome <span th:text="${#authentication.principal.profile.firstName}"></span>!</h3>

                    <hr>
                </div>
                <div class="card-body">
                    <div>
                        <div>
                            <img th:if="${user.profile.uploadPath == null}" th:src="@{/img/defaultavatar.png}" alt="none" class="avatar-img" />
                            <img th:if="${user.profile.uploadPath}"  th:src="@{/uploads/} + ${user.profile.uploadPath}"  class="avatar-img" />
                        </div>
                    </div>

                    <div class="profile-data">
                        <p>Have a wonderful Day!</p>
                        <div class="row">
                            <div class="profile-item">Your username:</div>
                            <div class="profile-value"><span th:text="${#authentication.principal.username}"></span></div>
                        </div>
                        <div class="row">
                            <div class="profile-item">Your name:</div>
                            <div class="profile-value"><span th:text="${#authentication.principal.profile.firstName} + ' ' + ${#authentication.principal.profile.lastName}"></span></div>
                        </div>

                        <div class="row">
                            <div class="profile-item">Your email:</div>
                            <div class="profile-value"> <span th:text="${#authentication.principal.profile.email}"></span></div>
                        </div>

                        <div class="row">
                            <div class="profile-item">Your state:</div>
                            <div class="profile-value"><span th:text="${#authentication.principal.profile.userState}"></span></div>
                        </div>

                    </div>




                </div>
            </div>
        </div>
        <br />

        <div class="col-md-6  col-sm-12" id="state-profile">
            <div class="card state-bg-photo m-3" th:style="@{background-image: url(} + ${photo.large1600Url}+ @{);}">
                <h3 class="card-title p-2 title-card text-center" th:text="${state.name}"></h3>

                <div class="card-body  d-flex flex-column align-items-center justify-content-between">
                    <div class="state">
                        <svg th:class="@{icon icon-state-} + ${state.abbr}" style="height: 200px;">
                            <use th:xlink:href="@{#icon-state-} + ${state.abbr}"></use>
                        </svg>
                    </div>

                    <div class="state-btn-list d-flex flex-row justify-content-between align-items-center">
                    <a class="btn btn-primary" th:href="@{/state/} + ${state.abbr}" style="color: white">View your State</a>


                      <div class="state-ranking">
                          <span class="state-user-rank">7.25</span>
                       <a th:href="@{/posts/state/} + ${state.abbr}" class="state-ranking-link">Update Rating</a>
                      </div>

                    </div>
                </div>
            </div>
        </div>

        <!--news tab for user's state-->
        <div class="col-md-6  col-sm-12">

            <div class="card m-3">
                <div class="card-header">
                    Recent <span th:text="${state.name}"></span> Discussions
                </div>
                <div class="card-body">
                    <!--<h5 class="card-title">Card title</h5>-->

                </div>
            </div>
        </div>

        <!--state and rating tab-->
        <div class="col-md-6 col-sm-12">
            <div class="card m-3">
                <div class="card-header">
                    <span th:text="${state.name}"></span> News
                </div>
                <div class="card-body">
                    <ul id="statenews" th:data-state-name="${#authentication.principal.profile.userState}"></ul>
                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#modal">View more News</button>
                </div>
            </div>
        </div>

        <div class="col-md-12 mt-5">
            <div class="card">
                <div class="card-body">
                    <h3 class="mb-3">Messages</h3>
                    <table class="table table-hover">
                        <thead>
                        <tr>
                            <th class="sticky-top">Username</th>
                            <th class="d-none d-sm-table-cell sticky-top">Message</th>
                            <th class="sticky-top">Status</th>

                        </tr>
                        </thead>
                        <tbody id="transaction-list">

                        <th:block th:each="c : ${conversations}">
                            <tr class="conversation"  th:data-id="${c.id}">
                                <td>
                                    <a th:href="@{~/messages/view/} + ${c.recipient.id}" th:text="${c.recipient.username}"></a>
                                </td>
                                <td>
                                    <span class="text-muted" th:text="${c.message} ">Since 05/01/2012</span>
                                </td>
                                <td><span>Unread</span>
                                </td>

                            </tr>

                        </th:block>

                        </tbody>
                    </table>
                </div>
            </div>

        </div>

        <!--notifications area-->

        <div class="row m-5 m-auto p-3">
            <div class="col-12 text-center">
                <h3>Share us on social media!</h3>
                <div class="col-12 m-4 d-inline">
                    <img class="fluid-img m-2" th:height="50" src="/img/Facebook.png">
                    <img class="fluid-img m-2" th:height="50" src="/img/Google%20Plus.png">
                </div>
            </div>
        </div>
    </div>
</div>


<div th:replace="partials/layout :: footer" />
<script th:src="@{~/built/news.js}"></script>

</body>
</html>